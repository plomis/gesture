!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Gesture=e()}(this,function(){"use strict";function t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function e(t,e){return t(e={exports:{}},e.exports),e.exports}var d=e(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),v=e(function(t){var e=t.exports={version:"2.6.5"};"number"==typeof __e&&(__e=e)}),r=function(t){return"object"==typeof t?null!==t:"function"==typeof t},a=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t},n=function(t){try{return!!t()}catch(t){return!0}},o=!n(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),i=d.document,c=r(i)&&r(i.createElement),s=function(t){return c?i.createElement(t):{}},u=!o&&!n(function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}),l=Object.defineProperty,f={f:o?Object.defineProperty:function(t,e,n){if(a(t),e=function(t,e){if(!r(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!r(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}(e,!0),a(n),u)try{return l(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},P=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},_=o?function(t,e,n){return f.f(t,e,P(1,n))}:function(t,e,n){return t[e]=n,t},h={}.hasOwnProperty,p=function(t,e){return h.call(t,e)},y=0,g=Math.random(),m=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++y+g).toString(36))},w=e(function(t){var e="__core-js_shared__",n=d[e]||(d[e]={});(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:v.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),b=w("native-function-to-string",Function.toString),O=e(function(t){var r=m("src"),e="toString",a=(""+b).split(e);v.inspectSource=function(t){return b.call(t)},(t.exports=function(t,e,n,o){var i="function"==typeof n;i&&(p(n,"name")||_(n,"name",e)),t[e]!==n&&(i&&(p(n,r)||_(n,r,t[e]?""+t[e]:a.join(e+""))),t===d?t[e]=n:o?t[e]?t[e]=n:_(t,e,n):(delete t[e],_(t,e,n)))})(Function.prototype,e,function(){return"function"==typeof this&&this[r]||b.call(this)})}),S=function(o,i,t){if(function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!")}(o),void 0===i)return o;switch(t){case 1:return function(t){return o.call(i,t)};case 2:return function(t,e){return o.call(i,t,e)};case 3:return function(t,e,n){return o.call(i,t,e,n)}}return function(){return o.apply(i,arguments)}},x="prototype",M=function(t,e,n){var o,i,r,a,c=t&M.F,s=t&M.G,u=t&M.P,l=t&M.B,f=s?d:t&M.S?d[e]||(d[e]={}):(d[e]||{})[x],h=s?v:v[e]||(v[e]={}),p=h[x]||(h[x]={});for(o in s&&(n=e),n)r=((i=!c&&f&&void 0!==f[o])?f:n)[o],a=l&&i?S(r,d):u&&"function"==typeof r?S(Function.call,r):r,f&&O(f,o,r,t&M.U),h[o]!=r&&_(h,o,a),u&&p[o]!=r&&(p[o]=r)};d.core=v,M.F=1,M.G=2,M.S=4,M.P=8,M.B=16,M.W=32,M.U=64,M.R=128;var E=M,T={}.toString,j=function(t){return T.call(t).slice(8,-1)},C=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==j(t)?t.split(""):Object(t)},L=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},k=function(t){return Object(L(t))},A=Math.ceil,R=Math.floor,D=function(t){return isNaN(t=+t)?0:(0<t?R:A)(t)},I=Math.min,F=function(t){return 0<t?I(D(t),9007199254740991):0},X=Array.isArray||function(t){return"Array"==j(t)},H=e(function(t){var e=w("wks"),n=d.Symbol,o="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=o&&n[t]||(o?n:m)("Symbol."+t))}).store=e}),K=H("species"),Y=function(t,e){return X(n=t)&&("function"!=typeof(o=n.constructor)||o!==Array&&!X(o.prototype)||(o=void 0),r(o)&&null===(o=o[K])&&(o=void 0)),new(void 0===o?Array:o)(e);var n,o},N=H("unscopables"),V=Array.prototype;null==V[N]&&_(V,N,{});var q,W,G,U,z,B,$,Z,J,Q=function(t){V[N][t]=!0},tt=(G=1==(q=5),U=2==q,z=3==q,B=4==q,$=6==q,Z=5==q||$,J=W||Y,function(t,e,n){for(var o,i,r=k(t),a=C(r),c=S(e,n,3),s=F(a.length),u=0,l=G?J(t,s):U?J(t,0):void 0;u<s;u++)if((Z||u in a)&&(i=c(o=a[u],u,r),q))if(G)l[u]=i;else if(i)switch(q){case 3:return!0;case 5:return o;case 6:return u;case 2:l.push(o)}else if(B)return!1;return $?-1:z||B?B:l}),et="find",nt=!0;et in[]&&Array(1)[et](function(){nt=!1}),E(E.P+E.F*nt,"Array",{find:function(t){return tt(this,t,1<arguments.length?arguments[1]:void 0)}}),Q(et);var ot=Math.max,it=Math.min,rt=function(t,e){return(t=D(t))<0?ot(t+e,0):it(t,e)};E(E.P,"Array",{fill:function(t){for(var e=k(this),n=F(e.length),o=arguments.length,i=rt(1<o?arguments[1]:void 0,n),r=2<o?arguments[2]:void 0,a=void 0===r?n:rt(r,n);i<a;)e[i++]=t;return e}}),Q("fill");var at=function(t){return C(L(t))},ct=function(c){return function(t,e,n){var o,i=at(t),r=F(i.length),a=rt(n,r);if(c&&e!=e){for(;a<r;)if((o=i[a++])!=o)return!0}else for(;a<r;a++)if((c||a in i)&&i[a]===e)return c||a||0;return!c&&-1}},st=ct(!0);E(E.P,"Array",{includes:function(t){return st(this,t,1<arguments.length?arguments[1]:void 0)}}),Q("includes");var ut=H("match"),lt=function(t,e,n){if(r(o=e)&&(void 0!==(i=o[ut])?i:"RegExp"==j(o)))throw TypeError("String#"+n+" doesn't accept regex!");var o,i;return L(t)+""},ft=H("match"),ht="includes";E(E.P+E.F*function(e){var n=/./;try{"/./"[e](n)}catch(t){try{return n[ft]=!1,!"/./"[e](n)}catch(t){}}return!0}(ht),"String",{includes:function(t){return!!~lt(this,t,ht).indexOf(t,1<arguments.length?arguments[1]:void 0)}});var pt=function(t,e){return{value:e,done:!!t}},dt={},vt=w("keys"),yt=function(t){return vt[t]||(vt[t]=m(t))},gt=ct(!1),mt=yt("IE_PROTO"),wt="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),bt=Object.keys||function(t){return function(t,e){var n,o=at(t),i=0,r=[];for(n in o)n!=mt&&p(o,n)&&r.push(n);for(;i<e.length;)p(o,n=e[i++])&&(~gt(r,n)||r.push(n));return r}(t,wt)},Pt=o?Object.defineProperties:function(t,e){a(t);for(var n,o=bt(e),i=o.length,r=0;r<i;)f.f(t,n=o[r++],e[n]);return t},_t=d.document,Ot=_t&&_t.documentElement,St=yt("IE_PROTO"),xt=function(){},Mt="prototype",Et=function(){var t,e=s("iframe"),n=wt.length;for(e.style.display="none",Ot.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),Et=t.F;n--;)delete Et[Mt][wt[n]];return Et()},Tt=Object.create||function(t,e){var n;return null!==t?(xt[Mt]=a(t),n=new xt,xt[Mt]=null,n[St]=t):n=Et(),void 0===e?n:Pt(n,e)},jt=f.f,Ct=H("toStringTag"),Lt=function(t,e,n){t&&!p(t=n?t:t.prototype,Ct)&&jt(t,Ct,{configurable:!0,value:e})},kt={};_(kt,H("iterator"),function(){return this});var At=yt("IE_PROTO"),Rt=Object.prototype,Dt=Object.getPrototypeOf||function(t){return t=k(t),p(t,At)?t[At]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Rt:null},It=H("iterator"),Ft=!([].keys&&"next"in[].keys()),Xt="values",Ht=function(){return this},Kt=function(t,e,n,o,i,r,a){var c,s;s=e,(c=n).prototype=Tt(kt,{next:P(1,o)}),Lt(c,s+" Iterator");var u,l,f,h=function(t){if(!Ft&&t in y)return y[t];switch(t){case"keys":case Xt:return function(){return new n(this,t)}}return function(){return new n(this,t)}},p=e+" Iterator",d=i==Xt,v=!1,y=t.prototype,g=y[It]||y["@@iterator"]||i&&y[i],m=g||h(i),w=i?d?h("entries"):m:void 0,b="Array"==e&&y.entries||g;if(b&&(f=Dt(b.call(new t)))!==Object.prototype&&f.next&&(Lt(f,p,!0),"function"!=typeof f[It]&&_(f,It,Ht)),d&&g&&g.name!==Xt&&(v=!0,m=function(){return g.call(this)}),(Ft||v||!y[It])&&_(y,It,m),dt[e]=m,dt[p]=Ht,i)if(u={values:d?m:h(Xt),keys:r?m:h("keys"),entries:w},a)for(l in u)l in y||O(y,l,u[l]);else E(E.P+E.F*(Ft||v),e,u);return u}(Array,"Array",function(t,e){this._t=at(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return t&&n<t.length?pt(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]]):(this._t=void 0,pt(1))},"values");dt.Arguments=dt.Array,Q("keys"),Q("values"),Q("entries");for(var Yt=H("iterator"),Nt=H("toStringTag"),Vt=dt.Array,qt={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},Wt=bt(qt),Gt=0;Gt<Wt.length;Gt++){var Ut,zt=Wt[Gt],Bt=qt[zt],$t=d[zt],Zt=$t&&$t.prototype;if(Zt&&(Zt[Yt]||_(Zt,Yt,Vt),Zt[Nt]||_(Zt,Nt,zt),dt[zt]=Vt,Bt))for(Ut in Kt)Zt[Ut]||O(Zt,Ut,Kt[Ut],!0)}function Jt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Qt={f:Object.getOwnPropertySymbols},te={f:{}.propertyIsEnumerable},ee=Object.assign,ne=!ee||n(function(){var t={},e={},n=Symbol(),o="abcdefghijklmnopqrst";return t[n]=7,o.split("").forEach(function(t){e[t]=t}),7!=ee({},t)[n]||Object.keys(ee({},e)).join("")!=o})?function(t,e){for(var n=k(t),o=arguments.length,i=1,r=Qt.f,a=te.f;i<o;)for(var c,s=C(arguments[i++]),u=r?bt(s).concat(r(s)):bt(s),l=u.length,f=0;f<l;)a.call(s,c=u[f++])&&(n[c]=s[c]);return n}:ee;E(E.S+E.F,"Object",{assign:ne});var oe=e(function(t,e){function n(){return!1}function o(){return!0}function i(){this.timeStamp=Date.now(),this.target=void 0,this.currentTarget=void 0}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype={isEventObject:1,constructor:i,isDefaultPrevented:n,isPropagationStopped:n,isImmediatePropagationStopped:n,preventDefault:function(){this.isDefaultPrevented=o},stopPropagation:function(){this.isPropagationStopped=o},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=o,this.stopPropagation()},halt:function(t){t?this.stopImmediatePropagation():this.stopPropagation(),this.preventDefault()}},e.default=i,t.exports=e.default});t(oe);var ie=Object.getOwnPropertySymbols,re=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var ce=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(t){o[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,o,i=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),r=1;r<arguments.length;r++){for(var a in n=Object(arguments[r]))re.call(n,a)&&(i[a]=n[a]);if(ie){o=ie(n);for(var c=0;c<o.length;c++)ae.call(n,o[c])&&(i[o[c]]=n[o[c]])}}return i},se=e(function(t,e){function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=n(oe),o=n(ce),i=!0,u=!1,l=["altKey","bubbles","cancelable","ctrlKey","currentTarget","eventPhase","metaKey","shiftKey","target","timeStamp","view","type"];function c(t){return null==t}var f=[{reg:/^key/,props:["char","charCode","key","keyCode","which"],fix:function(t,e){c(t.which)&&(t.which=c(e.charCode)?e.keyCode:e.charCode),void 0===t.metaKey&&(t.metaKey=t.ctrlKey)}},{reg:/^touch/,props:["touches","changedTouches","targetTouches"]},{reg:/^hashchange$/,props:["newURL","oldURL"]},{reg:/^gesturechange$/i,props:["rotation","scale"]},{reg:/^(mousewheel|DOMMouseScroll)$/,props:[],fix:function(t,e){var n=void 0,o=void 0,i=void 0,r=e.wheelDelta,a=e.axis,c=e.wheelDeltaY,s=e.wheelDeltaX,u=e.detail;r&&(i=r/120),u&&(i=0-(u%3==0?u/3:u)),void 0!==a&&(a===t.HORIZONTAL_AXIS?n=(o=0)-i:a===t.VERTICAL_AXIS&&(n=0,o=i)),void 0!==c&&(o=c/120),void 0!==s&&(n=-1*s/120),n||o||(o=i),void 0!==n&&(t.deltaX=n),void 0!==o&&(t.deltaY=o),void 0!==i&&(t.delta=i)}},{reg:/^mouse|contextmenu|click|mspointer|(^DOMMouseScroll$)/i,props:["buttons","clientX","clientY","button","offsetX","relatedTarget","which","fromElement","toElement","offsetY","pageX","pageY","screenX","screenY"],fix:function(t,e){var n=void 0,o=void 0,i=void 0,r=t.target,a=e.button;return r&&c(t.pageX)&&!c(e.clientX)&&(i=(n=r.ownerDocument||document).body,t.pageX=e.clientX+((o=n.documentElement)&&o.scrollLeft||i&&i.scrollLeft||0)-(o&&o.clientLeft||i&&i.clientLeft||0),t.pageY=e.clientY+(o&&o.scrollTop||i&&i.scrollTop||0)-(o&&o.clientTop||i&&i.clientTop||0)),t.which||void 0===a||(t.which=1&a?1:2&a?3:4&a?2:0),!t.relatedTarget&&t.fromElement&&(t.relatedTarget=t.fromElement===r?t.toElement:t.fromElement),t}}];function h(){return i}function p(){return u}function r(t){var e=t.type,n="function"==typeof t.stopPropagation||"boolean"==typeof t.cancelBubble;s.default.call(this);var o=p;"defaultPrevented"in(this.nativeEvent=t)?o=t.defaultPrevented?h:p:"getPreventDefault"in t?o=t.getPreventDefault()?h:p:"returnValue"in t&&(o=t.returnValue===u?h:p),this.isDefaultPrevented=o;var i=[],r=void 0,a=void 0,c=l.concat();for(f.forEach(function(t){e.match(t.reg)&&(c=c.concat(t.props),t.fix&&i.push(t.fix))}),r=c.length;r;)this[a=c[--r]]=t[a];for(!this.target&&n&&(this.target=t.srcElement||document),this.target&&3===this.target.nodeType&&(this.target=this.target.parentNode),r=i.length;r;)(0,i[--r])(this,t);this.timeStamp=t.timeStamp||Date.now()}var a=s.default.prototype;(0,o.default)(r.prototype,a,{constructor:r,preventDefault:function(){var t=this.nativeEvent;t.preventDefault?t.preventDefault():t.returnValue=u,a.preventDefault.call(this)},stopPropagation:function(){var t=this.nativeEvent;t.stopPropagation?t.stopPropagation():t.cancelBubble=i,a.stopPropagation.call(this)}}),e.default=r,t.exports=e.default});t(se);var ue=t(e(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(n,t,o,e){function i(t){var e=new c.default(t);o.call(n,e)}if(n.addEventListener){var r=(a=!1,"object"==typeof e?a=e.capture||!1:"boolean"==typeof e&&(a=e),n.addEventListener(t,i,e||!1),{v:{remove:function(){n.removeEventListener(t,i,a)}}});if("object"==typeof r)return r.v}else if(n.attachEvent)return n.attachEvent("on"+t,i),{remove:function(){n.detachEvent("on"+t,i)}};var a};var n,c=(n=se)&&n.__esModule?n:{default:n};t.exports=e.default}));function le(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function fe(){return screen.orientation&&le(window,"onorientationchange")?screen.orientation.type.includes("landscape"):window.innerHeight<window.innerWidth}function he(t,e){for(var n=0,o=t.length;n<o;n++)t[n](e)}for(var pe=function(){var o,t,e,n=window.whatenvis,i=(o=navigator.userAgent.toLowerCase(),function(t){return t.reduce(function(t,e){if(!1!==t)return t;var n=o.match(e);return n?n[1]||!0:t},!1)}),r={android:i([/android\s([\d.]+)/]),macos:i([/\(macintosh;\sintel\smac\sos\sx\s([\d_]+)/]),windows:i([/windows\snt\s([\d.]+)/]),ios:i([/\(i[^;]+;( U;)? CPU.+Mac OS X/]),ipad:i([/\(ipad.*os\s([\d_]+)/]),iphone:i([/iphone\sos\s([\d_]+)/]),windowsPhone:i([/windows\sphone\s([\d.]+)/]),androidPhone:i([/android\s([\d.]+).*\smobile\s.*/]),kindle:i([/kindle\/([\d.]+)/]),ie:i([/msie ([\d.]+)/,/rv:([\d.]+)\) like gecko/]),edge:i([/edge\/([\d.]+)/]),firefox:i([/firefox\/([\d.]+)/]),opera:i([/(?:opera|opr).([\d.]+)/]),chrome:i([/chrome\/([\d.]+)/,/crios\/([\d.]+)/]),chromeMobile:i([/crios\/([\d.]+)/]),safari:i([/version\/([\d.]+).*safari/]),wechat:i([/micromessenger\/([\d.]+)/]),alipay:i([/alipayclient\/([\d.]+)/])},a=i([/android\s.*;\s([^;]*)\sbuild\/.*/]),c=a&&a.match(/\spad\s/);if(r.androidPhone=r.androidPhone&&!c,r.chrome=!r.edge&&r.chrome,r.safari=!!(r.ios||r.macos||r.windows)&&r.safari,r.androidTablet=!r.androidPhone&&!!r.android,r.windowsTablet=i([/touch/])&&!r.windowsPhone&&r.windows,r.phone=!!(r.iphone||r.androidPhone||r.windowsPhone),r.tablet=!!(r.ipad||r.androidTablet||r.windowsTablet||i([/tablet/])),r.safariMobile=(r.ipad||r.iphone)&&r.safari,r.iosWechat=r.ios&&r.wechat,r.androidWechat=r.android&&r.wechat,r.iosAlipay=r.ios&&r.alipay,r.androidAlipay=r.android&&r.alipay,r.pc=!r.phone&&!r.tablet&&!r.kindle,r.tablet||r.phone){r.landscape=fe(),r.portrait=!r.landscape;var s=[];r.onChangeOrientation=function(t){"function"==typeof t&&s.push(t)};var u="resize";le(window,"onorientationchange")&&(u="orientationchange"),window.addEventListener&&window.addEventListener(u,(t=s,e=function(){r.landscape=fe(),r.portrait=!r.landscape},function(){fe()?he(t,"landscape"):he(t,"portrait"),e()}),!1)}return r.noConflict=function(){return window.whatenvis=n,r},window.whatenvis=r}(),de=0,ve=["ms","moz","webkit","o"],ye=window.requestAnimationFrame,ge=window.cancelAnimationFrame,me=0;me<4&&!ye;++me)ye=window[ve[me]+"RequestAnimationFrame"],ge=window[ve[me]+"CancelAnimationFrame"]||window[ve[me]+"CancelRequestAnimationFrame"];ye||(ye=function(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-de)),o=window.setTimeout(function(){t(e+n)},n);return de=e+n,o}),ge||(ge=function(t){clearTimeout(t)});var we=ye;var be={arraySize:3,sideLength:300,onStateChange:function(){},onChange:function(){},onEnd:function(){},circleRadius:0,pointRadius:0,lineWidth:3,stateColors:{normal:"#afafaf",selected:"#ffffff",checking:"#ffffff",success:"#2CFF26",error:"#de462d"}};function Pe(t,e){this.wrapper="string"==typeof t?document.querySelector(t):t,this.wrapper||console.warn("Can not resolve the wrapper DOM."),this._init(e)}return Pe.prototype._init=function(t){if(this.mouseDownEvent=null,this.mouseMoveEvent=null,this.mouseUpEvent=null,this.touchCancel=null,this.touchEnd=null,this.touchMove=null,this.touchStart=null,this.state="normal",this.devicePixelRatio=window.devicePixelRatio||1,this.hitPointId=null,this.totalPoints=[],this.hitPoints=[],this.touchPoint=null,this.options=Object.assign({},be,t),0===this.options.circleRadius){var e=this.options,n=e.sideLength*this.devicePixelRatio/(1+4*e.arraySize);this.options.circleRadius=n,this.options.pointRadius=n/3}this._initCanvas(),this._initKey(),this._draw(),this._initMouseEvent()},Pe.prototype._initCanvas=function(){var t=document.createElement("canvas"),e=this.options.sideLength;t.width=this.devicePixelRatio*e,t.height=this.devicePixelRatio*e,t.style.width=e+"px",t.style.height=e+"px",t.style.backgroundColor="transparent",this.canvas=t,this.context=t.getContext("2d"),this.wrapper.appendChild(t)},Pe.prototype._initKey=function(){for(var t=0,e=this.options.arraySize,n=this.options.circleRadius,o=0;o<e;o++)for(var i=0;i<e;i++){this.totalPoints.push({x:4*i*n+2.5*n,y:4*o*n+2.5*n,index:++t,row:o+1,col:i+1})}},Pe.prototype._draw=function(){var n=this;this._clearCanvas();var o=this.options.stateColors,i=this.context,r=this.state,t=this.totalPoints,e=this.touchPoint,a=this.hitPoints;this._drawLine(i,e?[].concat(Jt(a),[e]):a,o[r]),t.forEach(function(t){var e=a.includes(t);n._drawKey(i,t.x,t.y,e,e?o[r]:o.normal)})},Pe.prototype._drawLine=function(e,t,n){1<t.length&&(e.strokeStyle=n,e.lineWidth=5,e.beginPath(),e.moveTo(t[0].x,t[0].y),t.forEach(function(t){return e.lineTo(t.x,t.y)}),e.stroke())},Pe.prototype._drawKey=function(t,e,n,o,i){var r=this.options,a=r.circleRadius,c=r.pointRadius,s=r.lineWidth;t.fillStyle=i,t.strokeStyle=i,t.lineWidth=s,t.beginPath(),t.arc(e,n,a,0,2*Math.PI,!0),t.closePath(),t.stroke(),o&&(t.lineWidth=0,t.beginPath(),t.arc(e,n,c,0,2*Math.PI,!0),t.fill())},Pe.prototype._clearCanvas=function(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height)},Pe.prototype._initMouseEvent=function(){var e=this;pe.pc?this.mouseDownEvent=ue(this.canvas,"mousedown",function(t){e._handleTouchStart(Object.assign(t,{touches:[{clientX:t.pageX,clientY:t.pageY}]})),e.mouseMoveEvent=ue(document,"mousemove",function(t){e._handleTouchMove(Object.assign(t,{touches:[{clientX:t.pageX,clientY:t.pageY}]}))}),e.mouseUpEvent=ue(document,"mouseup",function(t){e._handleTouchCancel(t),e.mouseUpEvent.remove(),e.mouseMoveEvent.remove()})}):(this.touchCancel=ue(this.canvas,"touchcanel",function(t){return e._handleTouchCancel(t)}),this.touchEnd=ue(this.canvas,"touchend",function(t){return e._handleTouchCancel(t)}),this.touchMove=ue(this.canvas,"touchmove",function(t){return e._handleTouchMove(t)}),this.touchStart=ue(this.canvas,"touchstart",function(t){return e._handleTouchStart(t)}))},Pe.prototype._handleTouchStart=function(t){t.stopPropagation(),t.preventDefault(),"normal"===this.state&&(this.state="selected"),"normal"===this.state&&this.options.onStateChange("selected"),this._handleHitPoint(t)},Pe.prototype._handleTouchMove=function(t){t.stopPropagation(),t.preventDefault(),this._handleHitPoint(t)},Pe.prototype._handleTouchCancel=function(t){t.stopPropagation(),t.preventDefault(),"selected"===this.state&&(this.state||(this.state="normal"),this.options.onStateChange("normal"),this._handleHitOver())},Pe.prototype._handleHitOver=function(){var t=this;we(function(){t.options.onEnd(t.hitPoints.map(function(t){return t.index})),t.touchPoint=null,t._draw()})},Pe.prototype._handleHitPoint=function(t){var r=this,a=t.touches;null===this.hitPointId&&(this.hitPointId=we(function(){r.hitPointId=null;var t,e,n=r.devicePixelRatio;if("selected"===r.state){var o=(t=r.canvas.getBoundingClientRect(),e=document.documentElement,{left:t.left+(window.pageXOffset||e.scrollLeft)-(e.clientLeft||document.body.clientLeft||0),top:t.top+(window.pageYOffset||e.scrollTop)-(e.clientTop||document.body.clientTop||0)});if(0<a.length){var i=a[0];r.touchPoint={x:(i.clientX-o.left)*n,y:(i.clientY-o.top)*n},r._updateKeyboard()}}}))},Pe.prototype._updateKeyboard=function(){this._updateKey(),this._updateLine()},Pe.prototype._updateKey=function(){var t=this.hitPoints,e=this.touchPoint,n=this.circleRadius,o=this._findHitPoint(e);if(o&&!t.includes(o)){if(0<t.length){var i=t[t.length-1],r=this._findNearPoints(i),a=this._findCrossover(e,i,r,n);a&&!t.includes(a)&&a.forEach(this._addHitPoint)}this._addHitPoint(o),this._draw()}},Pe.prototype._updateLine=function(){this._draw()},Pe.prototype._addHitPoint=function(t){var e=this.hitPoints;e.push(t),this.options.onChange(e.map(function(t){return t.index}))},Pe.prototype._findHitPoint=function(e){var n=this.options.circleRadius;return this.totalPoints.find(function(t){return Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)<=Math.pow(n,2)})},Pe.prototype._findNearPoints=function(e){var n=this.hitPoints;return this.totalPoints.filter(function(t){return!n.includes(t)&&Math.abs(t.row-e.row)<=1&&Math.abs(t.col-e.col)<=1})},Pe.prototype._findCrossover=function(o,t,e,n){if(0<e.length){var i=e.reduce(function(t,e){var n=Math.pow(o.x-e.x,2)+Math.pow(o.y-e.y,2);return t?n<t.distance?{circleCenter:e,distance:n}:t:{circleCenter:e,distance:n}},null).circleCenter,r=Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2),a=Math.pow(t.x-o.x,2)+Math.pow(t.y-o.y,2),c=Math.pow(i.x-o.x,2)+Math.pow(i.y-o.y,2);if(r-Math.pow(n,2)<a&&c<a){var s=(1-Math.pow((r+c-a)/(2*Math.sqrt(r)*Math.sqrt(c)),2))*r;return Math.pow(n,2)<s?[]:[i]}}return[]},Pe.prototype.changeState=function(t){this.state=t,this._draw()},Pe.prototype.reset=function(){this.hitPoints=[],this._draw()},Pe.version="1.0.0",Pe});
